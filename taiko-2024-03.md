
## Gas Optimizations


| |Issue|Instances|
|-|:-|:-:|
| [GAS-2](#GAS-2) | `abi.encode` is more efficient than `abi.encodePacked` | 21 |
| [GAS-3](#GAS-3) | With assembly, .call (bool success) transfer can be done gas-optimized | 1 |
| [GAS-4](#GAS-4) | Use assembly to emit events | 56 |
| [GAS-5](#GAS-5) | Use assembly for small keccak256 hashes, in order to save gas | 7 |
| [GAS-6](#GAS-6) | Redundant event fields can be removed | 1 |
| [GAS-7](#GAS-7) | Use uint256(1)/uint256(2) instead for true and false boolean states | 10 |
| [GAS-9](#GAS-9) | For Operations that will not overflow, you could use unchecked | 82 |
| [GAS-12](#GAS-12) | Use of emit inside a loop | 3 |
| [GAS-13](#GAS-13) | >=/ <= costs less gas than >/< | 96 |
| [GAS-14](#GAS-14) | Use hardcode address instead of address(this)  | 39 |
| [GAS-15](#GAS-15) | uint256 variable initialization to default value of 0 can be omitted | 13 |
| [GAS-16](#GAS-16) | Long revert strings | 1 |
| [GAS-17](#GAS-17) | Constructors can be marked payable | 3 |
| [GAS-22](#GAS-22) | Usage of smaller uint/int types causes overhead | 302 |
| [GAS-24](#GAS-24) | Using this to access functions results in an external call, wasting gas | 3 |




Total: 786 instances over 26 issues


 ### [GAS-2] `abi.encode` is more efficient than `abi.encodePacked`
`abi.encode` uses less gas than `abi.encodePacked`: the gas saved depends on the number of arguments, with an average of ~90 per argument. Test available here.

<details>
<summary>There are 21 instances of this issue:</summary>

---

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

204:         meta_.difficulty = keccak256(abi.encodePacked(block.prevrandao, b.numBlocks, block.number));

```

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

163:         bytes memory retData = abi.encodePacked(INVALID_EXIT_CODE);

315:             abi.encodePacked(authDataV3.ecdsaAttestationKey, authDataV3.qeAuthData.data);

369:         bytes memory retData = abi.encodePacked(INVALID_EXIT_CODE);

482:         retData = abi.encodePacked(sha256(abi.encode(v3quote)), tcbStatus);

```

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

181:             cert.signature = abi.encodePacked(sigX, sigY);

```

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

119:         bytes memory headerBytes = abi.encodePacked(

129:         signedQuoteData = abi.encodePacked(headerBytes, V3Parser.packQEReport(localEnclaveReport));

251:         packedQEReport = abi.encodePacked(

```

```solidity
File: packages/protocol/contracts/libs/Lib4844.sol

44:             abi.encodePacked(_blobHash, _x, _y, _commitment, _pointProof)

```

```solidity
File: packages/protocol/contracts/libs/LibTrieProof.sol

48:                 SecureMerkleTrie.get(abi.encodePacked(_addr), _accountProof, _rootHash);

```

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

203:         return keccak256(abi.encodePacked("SIGNAL", _chainId, _app, _signal));

```

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

170:         bytes32 hash = keccak256(abi.encodePacked("Withdraw unlocked Taiko token to: ", _to));

```

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol

17:             out_ = abi.encodePacked(_writeLength(_in.length, 128), _in);

56:         bytes memory b = abi.encodePacked(_x);

```

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

81:         bytes memory currentNodeID = abi.encodePacked(_root);

94:                     Bytes.equal(abi.encodePacked(keccak256(currentNode.encoded)), currentNodeID),

100:                     Bytes.equal(abi.encodePacked(keccak256(currentNode.encoded)), currentNodeID),

```

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol

55:         hash_ = abi.encodePacked(keccak256(_key));

```

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

109:             abi.encodePacked(

```

```solidity
File: packages/protocol/contracts/tokenvault/LibBridgedToken.sol

54:             abi.encodePacked(

```
[[204]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L204)
,[[163]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L163)
,[[315]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L315)
,[[369]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L369)
,[[482]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L482)
,[[181]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L181)
,[[119]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L119)
,[[129]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L129)
,[[251]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L251)
,[[44]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L44)
,[[48]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L48)
,[[203]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L203)
,[[170]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L170)
,[[17]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L17)
,[[56]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L56)
,[[81]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L81)
,[[94]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L94)
,[[100]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L100)
,[[55]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L55)
,[[109]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L109)
,[[54]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L54)
,
</details>


 ### [GAS-3] With assembly, .call (bool success) transfer can be done gas-optimized
When using assembly language, it is possible to call the transfer function of an Ethereum contract in a gas-optimized way by using the .call function with specific input parameters. The .call function takes a number of input parameters, including the address of the contract to call, the amount of Ether to transfer, and a specification of the gas limit for the call. By specifying a lower gas limit than the default, it is possible to reduce the gas cost of the transfer.


Instances of this issue:

```solidity
File: packages/protocol/contracts/L2/CrossChainOwned.sol

50:         (bool success,) = address(this).call(txdata);

```
[[50]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L50)
,
 ### [GAS-4] Use assembly to emit events
We can use assembly to emit events efficiently by utilizing `scratch space` and the `free memory pointer`. This will allow us to potentially avoid memory expansion costs. Note: In order to do this optimization safely, we will need to cache and restore the free memory pointer.

<details>
<summary>There are 56 instances of this issue:</summary>

---

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

129:         emit BlockAssigned(_blk.assignedProver, _meta, assignment);

```

```solidity
File: packages/protocol/contracts/L1/libs/LibDepositing.sol

50:         emit EthDeposited(

```

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

166:                     emit BlobCached(meta_.blobHash);

273:         emit BlockProposed({

```

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

80:         emit ProvingPaused(_pause);

209:             emit TransitionProved({

230:                 emit TransitionProved({

254:                 emit TransitionContested({

```

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

73:         emit BlockVerified({

198:                 emit BlockVerified({

```

```solidity
File: packages/protocol/contracts/L1/provers/GuardianProver.sol

54:         emit GuardianApproval(msg.sender, _meta.id, _tran.blockHash, approved_);

```

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

95:         emit GuardiansUpdated(version, _newGuardians);

121:         emit Approved(_operationId, _approval, approved_);

```

```solidity
File: packages/protocol/contracts/L2/CrossChainOwned.sol

53:         emit TransactionExecuted(nextTxId++, bytes4(txdata));

```

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

157:         emit Anchored(blockhash(parentId), gasExcess); //@audit do not emit state 

157:         emit Anchored(blockhash(parentId), gasExcess); //@audit do not emit state 

```

```solidity
File: packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol

39:         emit ConfigAndExcessChanged(_newConfig, _newGasExcess);

```

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

93:             emit MessageSuspended(msgHash, _suspend);

111:         emit AddressBanned(_addr, _ban);

151:         emit MessageSent(msgHash_, message_);

208:             emit MessageRecalled(msgHash);

210:             emit MessageReceived(msgHash, _message, true);

301:             emit MessageExecuted(msgHash);

303:             emit MessageReceived(msgHash, _message, false);

336:         emit MessageRetried(msgHash);

519:         emit MessageStatusChanged(_msgHash, _status);

```

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

50:         emit AddressSet(_chainId, _name, _newAddress, oldAddress);

```

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

71:         emit Paused(msg.sender);

80:         emit Unpaused(msg.sender);

```

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

59:         emit Authorized(_addr, _authorize);

250:         emit ChainDataSynced(_chainId, _blockId, _kind, _chainData, signal_);

268:         emit SignalSent(_app, _signal, slot_, _value);

```

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

143:         emit Granted(_recipient, _grant);

157:         emit Voided(_recipient, amountVoided);

222:         emit Withdrawn(_recipient, _to, amountToWithdraw, costToWithdraw);

```

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

93:         emit Withdrawn(user, amount);

```

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

74:         emit Claimed(hash);

```

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20Base.sol

51:         emit MigrationStatusChanged(_migratingAddress, _migratingInbound);

63:             emit MigratedTo(_migratingAddress, _account, _amount); //@audit cache migratingAddress

81:             emit MigratedTo(_migratingAddress, _account, _amount); 

```

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

80:         emit TokenSent({

114:         emit TokenReceived({

149:         emit TokenReleased({

314:         emit BridgedTokenDeployed({

```

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

191:         emit BridgedTokenChanged({

241:         emit TokenSent({

273:         emit TokenReceived({

306:         emit TokenReleased({

425:         emit BridgedTokenDeployed({

```

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

64:         emit TokenSent({

97:         emit TokenReceived({

131:         emit TokenReleased({

250:         emit BridgedTokenDeployed({

```

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

109:             emit InstanceDeleted(idx, instances[idx].addr);

220:             emit InstanceAdded(nextInstanceId, _instances[i], address(0), validSince);

230:         emit InstanceAdded(id, newInstance, oldInstance, block.timestamp);

```
[[129]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L129)
,[[50]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L50)
,[[166]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L166)
,[[273]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L273)
,[[80]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L80)
,[[209]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L209)
,[[230]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L230)
,[[254]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L254)
,[[73]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L73)
,[[198]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L198)
,[[54]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L54)
,[[95]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L95)
,[[121]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L121)
,[[53]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L53)
,[[157]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L157)
,[[157]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L157)
,[[39]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L39)
,[[93]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L93)
,[[111]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L111)
,[[151]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L151)
,[[208]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L208)
,[[210]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L210)
,[[301]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L301)
,[[303]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L303)
,[[336]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L336)
,[[519]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L519)
,[[50]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L50)
,[[71]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L71)
,[[80]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L80)
,[[59]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L59)
,[[250]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L250)
,[[268]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L268)
,[[143]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L143)
,[[157]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L157)
,[[222]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L222)
,[[93]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L93)
,[[74]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L74)
,[[51]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L51)
,[[63]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L63)
,[[81]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L81)
,[[80]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L80)
,[[114]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L114)
,[[149]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L149)
,[[314]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L314)
,[[191]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L191)
,[[241]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L241)
,[[273]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L273)
,[[306]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L306)
,[[425]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L425)
,[[64]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L64)
,[[97]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L97)
,[[131]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L131)
,[[250]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L250)
,[[109]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L109)
,[[220]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L220)
,[[230]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L230)
,
</details>


 ### [GAS-5] Use assembly for small keccak256 hashes, in order to save gas
Use assembly for small keccak256 hashes, in order to save gas


Instances of this issue:

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

126:                 depositsHash: keccak256(abi.encode(deposits_)),

213:             metaHash: keccak256(abi.encode(meta_)),

```

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

121:         if (blk.blockId != _meta.id || blk.metaHash != keccak256(abi.encode(_meta))) {

```

```solidity
File: packages/protocol/contracts/L1/provers/GuardianProver.sol

46:         bytes32 hash = keccak256(abi.encode(_meta, _tran));

```

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

450:         return keccak256(abi.encode("TAIKO_MESSAGE", _message));

```

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

186:         return keccak256(abi.encode(_chainId, _kind, _blockId));

```

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

68:         bytes32 hash = keccak256(abi.encode("CLAIM_TAIKO_AIRDROP", data));

```
[[126]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L126)
,[[213]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L213)
,[[121]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L121)
,[[46]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L46)
,[[450]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L450)
,[[186]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L186)
,[[68]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L68)
,
 ### [GAS-6] Redundant event fields can be removed  
Some parameters (block.timestamp and block.number) are added to event information by default so re-adding them wastes gas, as they are already included.


Instances of this issue:

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

230:         emit InstanceAdded(id, newInstance, oldInstance, block.timestamp);

```
[[230]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L230)
,


 ### [GAS-9] For Operations that will not overflow, you could use unchecked

<details>
<summary>There are 82 instances of this issue:</summary>



X * 2 is equivalent to X << 1 and X / 2 is the same as X >> 1.
 The MUL and DIV opcodes cost 5 gas, whereas SHL and SHR only cost 3 gas.


Instances of this issue:

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

21:     uint256 public constant MAX_BYTES_PER_BLOB = 4096 * 32;

```

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

251:                 || _config.blockMaxTxListBytes > 128 * 1024 // calldata up to 128K

```

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

213:         config_.gasTargetPerL1Block = 15 * 1e6 * 4;

```

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

359:                 ? uint16(bytes2(svnValueBytes)) / 256

```

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

155:             uint256 upperDigit = digits / 16;

```

```solidity
File: packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol

145:         return uint256(der.readBytesN(ptr.ixf(), len) >> (32 - len) * 8);

203:                     der.readBytesN(ix + 2, lengthbytesLength) >> (32 - lengthbytesLength) * 8

```
[[21]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L21)
,[[251]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L251)
,[[213]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L213)
,[[359]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L359)
,[[155]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L155)
,[[145]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L145)
,[[203]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L203)
,
 ### [GAS-12] Use of emit inside a loop
Emitting an event inside a loop performs a LOG op N times, where N is the loop length. Consider refactoring the code to emit the event only once at the end of loop. Gas savings should be multiplied by the average loop length.


Instances of this issue:

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

90:         for (uint256 i; i < _msgHashes.length; ++i) {

```

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

104:         for (uint256 i; i < _ids.length; ++i) {

210:         for (uint256 i; i < _instances.length; ++i) {

```
[[90]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L90)
,[[104]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L104)
,[[210]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L210)
,
 ### [GAS-13] >=/ <= costs less gas than >/<
The compiler uses opcodes GT and ISZERO for solidity code that uses >, but only requires LT for >=,which saves 3 gas

<details>
<summary>There are 96 instances of this issue:</summary>

---

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

82:             block.timestamp > assignment.expiry

85:                 || assignment.maxBlockId != 0 && _meta.id > assignment.maxBlockId

86:                 || assignment.maxProposedIn != 0 && block.number > assignment.maxProposedIn

125:         if (address(this).balance > 0) { //@audit use assembly

```

```solidity
File: packages/protocol/contracts/L1/libs/LibDepositing.sol

89:                     recipient: address(uint160(data >> 96)),

93:                 uint96 _fee = deposits_[i].amount > fee ? fee : deposits_[i].amount;

139:             return _amount >= _config.ethDepositMinAmount && _amount <= _config.ethDepositMaxAmount

150:         if (_amount > type(uint96).max) revert L1_INVALID_ETH_DEPOSIT();

```

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

98:         if (b.numBlocks >= b.lastVerifiedBlockId + _config.blockMaxProposals + 1) {

171:             if (uint256(params.txListByteOffset) + params.txListByteSize > MAX_BYTES_PER_BLOB) {

195:         if (meta_.txListByteSize == 0 || meta_.txListByteSize > _config.blockMaxTxListBytes) {

296:         return _state.reusableBlobs[_blobHash] + _config.blobExpiry > block.timestamp;

```

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

111:         if (_meta.id <= b.lastVerifiedBlockId || _meta.id >= b.numBlocks) {

192:             bool returnLivenessBond = blk.livenessBond > 0 && _proof.data.length == 32

203:         if (_proof.tier > ts.tier) {

366:                 reward = _ts.contestBond >> 2;

370:                 reward = _ts.validityBond >> 2;

376:             reward = _ts.validityBond >> 1;

381:             if (reward > _tier.validityBond) {

415:             + _tier.provingWindow * 60 >= block.timestamp;

```

```solidity
File: packages/protocol/contracts/L1/libs/LibUtils.sol

34:         if (_blockId < b.lastVerifiedBlockId || _blockId >= b.numBlocks) {

86:         if (tid_ >= _blk.nextTransitionId) revert L1_UNEXPECTED_TRANSITION_ID();

```

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

185:                     bondToReturn -= blk.livenessBond >> 1;

212:             if (numBlocksVerified > 0) {

238:         if (_lastVerifiedBlockId > lastSyncedBlock + _config.blockSyncThreshold) {

251:                 || _config.blockMaxTxListBytes > 128 * 1024 // calldata up to 128K

256:             || _config.ethDepositMaxCountPerBlock > 32

260:                 || _config.ethDepositMaxAmount > type(uint96).max || _config.ethDepositGas == 0

262:                 || _config.ethDepositMaxFee > type(uint96).max / _config.ethDepositMaxCountPerBlock

```

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

63:         if (_newGuardians.length < MIN_NUM_GUARDIANS || _newGuardians.length > type(uint8).max) {

68:         if (_minGuardians < (_newGuardians.length + 1) >> 1 || _minGuardians > _newGuardians.length)

136:                 bits >>= 1;

```

```solidity
File: packages/protocol/contracts/L2/Lib1559Math.sol

42:         if (input > LibFixedPointMath.MAX_EXP_INPUT) {

```

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

82:         if (block.chainid <= 1 || block.chainid > type(uint64).max) {

145:         if (_l1BlockId > lastSyncedBlock + BLOCK_SYNC_THRESHOLD) {

201:         if (_blockId >= block.number) return 0; //@audit we can cache block.number

202:         if (_blockId + 256 >= block.number) return blockhash(_blockId);

234:             for (uint256 i; i < 255 && _blockId >= i + 1; ++i) {

263:         if (_gasExcess > 0) {

277:             if (_lastSyncedBlock > 0 && _l1BlockId > _lastSyncedBlock) { //@audit cache state variable

277:             if (_lastSyncedBlock > 0 && _l1BlockId > _lastSyncedBlock) { //@audit cache state variable

281:             if (numL1Blocks > 0) {

283:                 excess = excess > issuance ? excess - issuance : 1;

```

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

216:             bool pceSvnIsHigherOrGreater = pck.sgxExtension.pcesvn >= current.pcesvn;

280:                 block.timestamp > certs[i].notBefore && block.timestamp < certs[i].notAfter;

```

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

56:             if (i > 0) {

```

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

116:         require(totalQuoteSize >= MINIMUM_QUOTE_LENGTH, "Invalid quote size");

218:         if (cert.certType < 1 || cert.certType > 5) {

249:         uint16 isvProdIdPackBE = (enclaveReport.isvProdId >> 8) | (enclaveReport.isvProdId << 8);

250:         uint16 isvSvnPackBE = (enclaveReport.isvSvn >> 8) | (enclaveReport.isvSvn << 8);

```

```solidity
File: packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol

20:         return uint80(self >> 80);

25:         return uint80(self >> 160);

```

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

90:                 if (shortest > 32) {

169:         return self.length >= offset + other.length && equals(self, offset, other, 0, other.length);

335:             require(char >= 0x30 && char <= 0x7A, "invalid char");

350:             ret = (ret << 3) | (decoded >> 2);

354:             ret = (ret << 1) | (decoded >> 4);

358:             ret = (ret << 4) | (decoded >> 1);

362:             ret = (ret << 2) | (decoded >> 3);

```

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

189:         if (block.timestamp >= invocationDelay + receivedAt) {

258:         if (block.timestamp >= invocationDelay + receivedAt) {

439:         } else if (block.chainid >= 32_300 && block.chainid <= 32_400) {

491:             _message.data.length >= 4 // msg can be empty

```

```solidity
File: packages/protocol/contracts/libs/Lib4844.sol

40:         if (_x >= BLS_MODULUS) revert POINT_X_TOO_LARGE();

41:         if (_y >= BLS_MODULUS) revert POINT_Y_TOO_LARGE();

```

```solidity
File: packages/protocol/contracts/libs/LibMath.sol

13:         return _a > _b ? _b : _a;

21:         return _a > _b ? _a : _b;

```

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

120:             bool isFullProof = hop.accountProof.length > 0;

```

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

260:         if (block.timestamp >= _start + _period) return _amount;

275:             if (_cliff > 0) revert INVALID_GRANT();

277:             if (_cliff > 0 && _cliff <= _start) revert INVALID_GRANT();

278:             if (_cliff >= _start + _period) revert INVALID_GRANT();

```

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

40:         if (claimEnd > block.timestamp || claimEnd + withdrawalWindow < block.timestamp) {

```

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

35:             merkleRoot == 0x0 || claimStart == 0 || claimEnd == 0 || claimStart > block.timestamp

```

```solidity
File: packages/protocol/contracts/thirdparty/optimism/Bytes.sol

25:             require(_length + 31 >= _length, "slice_overflow");

26:             require(_start + _length >= _start, "slice_overflow");

27:             require(_bytes.length >= _start + _length, "slice_outOfBounds");

92:         if (_start >= _bytes.length) { //@audit cache length

```

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

38:             _in.length > 0,

153:             _in.length > 0,

173:                 _in.length > strLen,

183:                 strLen != 1 || firstByteOfContent >= 0x80,

193:                 _in.length > lenOfStrLen,

194:                 "RLPReader: length of content must be > than length of string length (long string)"

213:                 strLen > 55,

218:                 _in.length > lenOfStrLen + strLen,

229:                 _in.length > listLen,

239:                 _in.length > lenOfListLen,

240:                 "RLPReader: length of content must be > than length of list length (long list)"

259:                 listLen > 55,

264:                 _in.length > lenOfListLen + listLen,

```

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

77:         require(_key.length > 0, "MerkleTrie: empty key");

97:             } else if (currentNode.encoded.length >= 32) {

120:                         value_.length > 0,

173:                         value_.length > 0,

```

```solidity
File: packages/protocol/contracts/tokenvault/BaseNFTVault.sol

145:         if (_op.tokenIds.length > MAX_TOKEN_PER_TXN) {

```
[[82]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L82)
,[[85]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L85)
,[[86]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L86)
,[[125]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L125)
,[[89]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L89)
,[[93]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L93)
,[[139]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L139)
,[[150]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L150)
,[[98]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L98)
,[[171]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L171)
,[[195]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L195)
,[[296]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L296)
,[[111]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L111)
,[[192]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L192)
,[[203]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L203)
,[[366]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L366)
,[[370]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L370)
,[[376]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L376)
,[[381]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L381)
,[[415]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L415)
,[[34]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L34)
,[[86]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L86)
,[[185]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L185)
,[[212]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L212)
,[[238]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L238)
,[[251]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L251)
,[[256]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L256)
,[[260]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L260)
,[[262]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L262)
,[[63]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L63)
,[[68]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L68)
,[[136]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L136)
,[[42]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/Lib1559Math.sol#L42)
,[[82]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L82)
,[[145]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L145)
,[[201]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L201)
,[[202]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L202)
,[[234]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L234)
,[[263]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L263)
,[[277]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L277)
,[[277]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L277)
,[[281]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L281)
,[[283]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L283)
,[[216]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L216)
,[[280]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L280)
,[[56]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L56)
,[[116]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L116)
,[[218]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L218)
,[[249]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L249)
,[[250]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L250)
,[[20]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L20)
,[[25]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L25)
,[[90]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L90)
,[[169]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L169)
,[[335]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L335)
,[[350]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L350)
,[[354]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L354)
,[[358]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L358)
,[[362]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L362)
,[[189]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L189)
,[[258]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L258)
,[[439]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L439)
,[[491]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L491)
,[[40]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L40)
,[[41]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L41)
,[[13]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibMath.sol#L13)
,[[21]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibMath.sol#L21)
,[[120]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L120)
,[[260]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L260)
,[[275]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L275)
,[[277]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L277)
,[[278]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L278)
,[[40]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L40)
,[[35]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L35)
,[[25]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L25)
,[[26]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L26)
,[[27]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L27)
,[[92]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L92)
,[[38]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L38)
,[[153]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L153)
,[[173]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L173)
,[[183]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L183)
,[[193]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L193)
,[[194]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L194)
,[[213]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L213)
,[[218]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L218)
,[[229]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L229)
,[[239]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L239)
,[[240]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L240)
,[[259]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L259)
,[[264]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L264)
,[[77]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L77)
,[[97]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L97)
,[[120]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L120)
,[[173]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L173)
,[[145]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L145)
,
</details>


 ### [GAS-14] Use hardcode address instead of address(this) 
Instead of using address(this), it is more gas-efficient to pre-calculate and use the hardcoded address. Foundry’s script.sol and solmate’s LibRlp.sol contracts can help achieve this. References: https://book.getfoundry.sh/reference/forge-std/compute-create-address

<details>
<summary>There are 39 instances of this issue:</summary>

---

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

61:         if (_to == address(this)) revert TKO_INVALID_ADDR();

79:         if (_to == address(this)) revert TKO_INVALID_ADDR();

```

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

125:         if (address(this).balance > 0) { //@audit use assembly

126:             taikoL1Address.sendEther(address(this).balance);

151:                 address(this),

```

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

238:             uint256 tkoBalance = tko.balanceOf(address(this));

253:                 IHook(params.hookCalls[i].hook).onBlockProposed{ value: address(this).balance }(

260:             if (address(this).balance != 0) {

261:                 msg.sender.sendEther(address(this).balance);

268:             if (tko.balanceOf(address(this)) != tkoBalance + _config.livenessBond) {

```

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

242:                 tko.transferFrom(msg.sender, address(this), tier.contestBond);

384:                 _tko.transferFrom(msg.sender, address(this), _tier.validityBond - reward);

```

```solidity
File: packages/protocol/contracts/L2/CrossChainOwned.sol

50:         (bool success,) = address(this).call(txdata);

```

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

174:             _to.sendEther(address(this).balance);

176:             IERC20(_token).safeTransfer(_to, IERC20(_token).balanceOf(address(this)));

```

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

174:             if (!ISignalService(signalService).isSignalSent(address(this), msgHash)) {

196:                 _storeContext(msgHash, address(this), _message.srcChainId);

343:             _app: address(this),

486:         assert(_message.from != address(this));

```

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

112:                 signalService = address(this);

131:         if (value == 0 || value != _loadSignalValue(address(this), signal)) {

149:         return _loadSignalValue(address(this), signal) == _chainData;

171:             chainData_ = _loadSignalValue(address(this), signal);

245:         _sendSignal(address(this), signal_, _chainData);

```

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

137:         if (_to == address(this)) revert BTOKEN_CANNOT_RECEIVE();

```

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

147:         if (_to == address(this)) revert BTOKEN_CANNOT_RECEIVE();

```

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

125:         if (_to == address(this)) revert BTOKEN_CANNOT_RECEIVE();

```

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

108:         if (to == address(0) || to == address(this)) revert VAULT_INVALID_TO();

226:             IERC1155(token).safeBatchTransferFrom(address(this), to, tokenIds, amounts, "");

272:                         to: address(this),

```

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

267:         if (to == address(0) || to == address(this)) revert VAULT_INVALID_TO();

378:             uint256 _balance = t.balanceOf(address(this));

379:             t.safeTransferFrom({ from: msg.sender, to: address(this), value: _amount });

380:             balanceChange_ = t.balanceOf(address(this)) - _balance;

```

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

91:         if (to == address(0) || to == address(this)) revert VAULT_INVALID_TO();

171:                 IERC721(token_).safeTransferFrom(address(this), _to, _tokenIds[i]);

211:                     t.safeTransferFrom(_user, address(this), _op.tokenIds[i]);

```

```solidity
File: packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol

48:         usdc.transferFrom(_from, address(this), _amount);

```

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

186:                 address(this),

```
[[61]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L61)
,[[79]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L79)
,[[125]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L125)
,[[126]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L126)
,[[151]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L151)
,[[238]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L238)
,[[253]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L253)
,[[260]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L260)
,[[261]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L261)
,[[268]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L268)
,[[242]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L242)
,[[384]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L384)
,[[50]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L50)
,[[174]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L174)
,[[176]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L176)
,[[174]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L174)
,[[196]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L196)
,[[343]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L343)
,[[486]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L486)
,[[112]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L112)
,[[131]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L131)
,[[149]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L149)
,[[171]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L171)
,[[245]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L245)
,[[137]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L137)
,[[147]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L147)
,[[125]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L125)
,[[108]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L108)
,[[226]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L226)
,[[272]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L272)
,[[267]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L267)
,[[378]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L378)
,[[379]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L379)
,[[380]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L380)
,[[91]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L91)
,[[171]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L171)
,[[211]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L211)
,[[48]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L48)
,[[186]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L186)
,
</details>


 ### [GAS-15] uint256 variable initialization to default value of 0 can be omitted
There is no need to initialize variables to their default values during declaration, since they are any way initialized to default value once declared.
<details>
<summary>There are 13 instances of this issue:</summary>

---

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

80:         for (uint256 i = 0; i < _newGuardians.length; ++i) {

```

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

51:         uint256 index = 0;

```

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

18:     bytes4 internal constant SUPPORTED_TEE_TYPE = 0;

```

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

80:         for (uint256 idx = 0; idx < shortest; idx += 32) {

331:         uint256 ret = 0;

```

```solidity
File: packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol

46:         uint256 timestamp = 0;

```

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

72:         uint256 itemCount = 0;

```

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol

58:         uint256 i = 0;

66:         for (uint256 j = 0; j < out_.length; j++) {

```

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

30:     uint8 internal constant PREFIX_EXTENSION_EVEN = 0;

82:         uint256 currentKeyIndex = 0; //@info can we initilize   

85:         for (uint256 i = 0; i < proof.length; i++) {

208:         for (uint256 i = 0; i < length;) {

```
[[80]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L80)
,[[51]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L51)
,[[18]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L18)
,[[80]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L80)
,[[331]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L331)
,[[46]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L46)
,[[72]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L72)
,[[58]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L58)
,[[66]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L66)
,[[30]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L30)
,[[82]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L82)
,[[85]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L85)
,[[208]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L208)
,
</details>


 ### [GAS-16] Long revert strings


Instances of this issue:

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

89:             require(currentKeyIndex <= key.length, "MerkleTrie: key index exceeds total key length");

```
[[89]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L89)
,
 ### [GAS-17] Constructors can be marked payable
 Payable functions cost less gas to execute, since the compiler does not have to add extra checks to ensure that a payment was not provided. A constructor can safely be marked as payable, since only the deployer would be able to pass funds, and the project itself would not pass any funds.


Instances of this issue:

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

54:     constructor(address sigVerifyLibAddr, address pemCertLibAddr) {

```

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

20:     constructor(address es256Verifier) {

```

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

64:     constructor() {

```
[[54]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L54)
,[[20]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L20)
,[[64]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L64)
,


Instances of this issue:

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

358:             uint16 svnValue = svnValueBytes.length < 2

```
[[358]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L358)
,
 ### [GAS-22] Usage of smaller uint/int types causes overhead
When using a smaller int/uint type it first needs to be converted to it's 258 bit counterpart to be operated, this increases the gass cost and thus should be avoided. However it does make sense to use smaller int/uint values within structs provided you pack the struct properly.

<details>
<summary>There are 302 instances of this issue:</summary>

---

```solidity
File: packages/protocol/contracts/L1/ITaikoL1.sol

27:     function proveBlock(uint64 _blockId, bytes calldata _input) external;

31:     function verifyBlocks(uint64 _maxBlocksToVerify) external;

```

```solidity
File: packages/protocol/contracts/L1/TaikoData.sol

15:         uint64 chainId;

20:         uint64 blockMaxProposals;

22:         uint64 blockRingBufferSize;

24:         uint64 maxBlocksToVerifyPerProposal;

26:         uint32 blockMaxGasLimit;

46:         uint64 ethDepositMinCountPerBlock;

48:         uint64 ethDepositMaxCountPerBlock;

59:         uint8 blockSyncThreshold; //@audit

64:         uint16 tier;

65:         uint128 fee;

69:         uint16 tier;

101:         uint64 id;

102:         uint32 gasLimit;

103:         uint64 timestamp; // slot 7

104:         uint64 l1Height;

107:         uint16 minTier;

130:         uint64 timestamp; // slot 6 (90 bits)

131:         uint16 tier;

132:         uint8 contestations;

141:         uint64 blockId; // slot 3

142:         uint64 proposedAt; // timestamp

143:         uint64 proposedIn; // L1 block number

144:         uint32 nextTransitionId;

145:         uint32 verifiedTransitionId;

153:         uint64 id;

162:         uint64 genesisHeight;

163:         uint64 genesisTimestamp;

164:         uint64 numEthDeposits;

165:         uint64 nextEthDepositToProcess;

169:         uint64 numBlocks;

170:         uint64 lastVerifiedBlockId;

172:         uint8 __reserved1;

173:         uint16 __reserved2;

174:         uint32 __reserved3;                 

175:         uint64 lastUnpausedAt;

181:         mapping(uint64 blockId_mod_blockRingBufferSize => Block blk) blocks;

183:         mapping(uint64 blockId => mapping(bytes32 parentHash => uint32 transitionId)) transitionIds;

183:         mapping(uint64 blockId => mapping(bytes32 parentHash => uint32 transitionId)) transitionIds;

186:             uint64 blockId_mod_blockRingBufferSize

187:                 => mapping(uint32 transitionId => TransitionState ts)

```

```solidity
File: packages/protocol/contracts/L1/TaikoEvents.sol

43:         uint16 tier,

44:         uint8 contestations

58:         uint16 tier

72:         uint16 tier

```

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

76:         uint64 _blockId,

94:         uint8 maxBlocksToVerify = LibProving.proveBlock(state, config, this, meta, tran, proof);

100:     function verifyBlocks(uint64 _maxBlocksToVerify)

145:     function getBlock(uint64 _blockId)

150:         uint64 slot;

163:         uint64 _blockId,

```

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

166:         uint16 _tierId

```

```solidity
File: packages/protocol/contracts/L1/libs/LibDepositing.sol

84:             uint64 j = _state.slotA.nextEthDepositToProcess;

```

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

37:         uint16 tier

51:         uint16 tier

100:         returns (uint8 maxBlocksToVerify_)

115:         uint64 slot = _meta.id % _config.blockRingBufferSize;

129:         (uint32 tid, TaikoData.TransitionState storage ts) =

273:         uint64 slot

276:         returns (uint32 tid_, TaikoData.TransitionState storage ts_)

405:         uint32 _tid,

```

```solidity
File: packages/protocol/contracts/L1/libs/LibUtils.sol

26:         uint64 _blockId,

38:         uint64 slot = _blockId % _config.blockRingBufferSize;

42:         uint32 tid = getTransitionId(_state, blk, slot, _parentHash);

55:         uint64 _blockId

59:         returns (TaikoData.Block storage blk_, uint64 slot_)

73:         uint64 _slot,

78:         returns (uint32 tid_)

```

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

34:         uint16 tier,

35:         uint8 contestations

89:         uint64 _maxBlocksToVerify

100:         uint64 blockId = b.lastVerifiedBlockId;

102:         uint64 slot = blockId % _config.blockRingBufferSize;

107:         uint32 tid = blk.verifiedTransitionId;

117:         uint64 numBlocksVerified;

213:                 uint64 lastVerifiedBlockId = b.lastVerifiedBlockId + numBlocksVerified;

227:         uint64 _lastVerifiedBlockId,

234:         (uint64 lastSyncedBlock,) = signalService.getSyncedChainData(

```

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

19:     mapping(uint32 version => mapping(bytes32 hash => uint256 approvalBits)) internal _approvals;

27:     uint32 public version;

30:     uint32 public minGuardians;

37:     event GuardiansUpdated(uint32 version, address[] guardians);

55:         uint8 _minGuardians

```

```solidity
File: packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol

20:     function getTier(uint16 _tierId) public pure override returns (ITierProvider.Tier memory) {

```

```solidity
File: packages/protocol/contracts/L1/tiers/ITierProvider.sol

13:         uint16 provingWindow; // in minutes

14:         uint8 maxBlocksToVerifyPerProof;

22:     function getTier(uint16 tierId) external view returns (Tier memory);

39:     uint16 public constant TIER_OPTIMISTIC = 100;

42:     uint16 public constant TIER_SGX = 200;

45:     uint16 public constant TIER_SGX_ZKVM = 300;

48:     uint16 public constant TIER_GUARDIAN = 1000;

```

```solidity
File: packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol

20:     function getTier(uint16 _tierId) public pure override returns (ITierProvider.Tier memory) {

```

```solidity
File: packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol

20:     function getTier(uint16 _tierId) public pure override returns (ITierProvider.Tier memory) {

```

```solidity
File: packages/protocol/contracts/L2/CrossChainOwned.sol

16:     uint64 public ownerChainId;

19:     uint64 public nextTxId;

26:     event TransactionExecuted(uint64 indexed txId, bytes4 indexed selector);

42:         (uint64 txId, bytes memory txdata) = abi.decode(_data, (uint64, bytes));

63:         uint64 _ownerChainId

```

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

27:         uint32 gasTargetPerL1Block;

28:         uint8 basefeeAdjustmentQuotient;

35:     uint8 public constant BLOCK_SYNC_THRESHOLD = 5;

47:     uint64 public gasExcess;

50:     uint64 public lastSyncedBlock;

57:     event Anchored(bytes32 parentHash, uint64 gasExcess);

74:         uint64 _l1ChainId,

75:         uint64 _gasExcess

110:         uint64 _l1BlockId,

111:         uint32 _parentGasUsed

186:         uint64 _l1BlockId,

187:         uint32 _parentGasUsed

200:     function getBlockHash(uint64 _blockId) public view returns (bytes32) {

254:         uint64 _l1BlockId,

255:         uint32 _parentGasUsed

259:         returns (uint256 basefee_, uint64 gasExcess_)

```

```solidity
File: packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol

18:     event ConfigAndExcessChanged(Config config, uint64 gasExcess);

27:         uint64 _newGasExcess

```

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

36:     uint8 internal constant INVALID_EXIT_CODE = 255; //@audit pack with address

```

```solidity
File: packages/protocol/contracts/automata-attestation/lib/EnclaveIdStruct.sol

10:         uint16 isvprodid;

23:         uint16 isvsvn;

```

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

358:             uint16 svnValue = svnValueBytes.length < 2

```

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

106:         uint32 totalQuoteSize = 48 // header

249:         uint16 isvProdIdPackBE = (enclaveReport.isvProdId >> 8) | (enclaveReport.isvProdId << 8);

250:         uint16 isvSvnPackBE = (enclaveReport.isvSvn >> 8) | (enclaveReport.isvSvn << 8);

```

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol

26:         uint16 isvProdId;

27:         uint16 isvSvn;

34:         uint16 parsedDataSize;

39:         uint16 certType;

43:         uint32 certDataSize;

```

```solidity
File: packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol

196:             uint8 lengthbytesLength = uint8(der[ix + 1] & 0x7F);

```

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

188:     function readUint8(bytes memory self, uint256 idx) internal pure returns (uint8 ret) {

198:     function readUint16(bytes memory self, uint256 idx) internal pure returns (uint16 ret) {

211:     function readUint32(bytes memory self, uint256 idx) internal pure returns (uint32 ret) {

332:         uint8 decoded;

```

```solidity
File: packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol

9:         uint16 yrs;

10:         uint8 mnths;

11:         uint8 dys;

12:         uint8 hrs;

13:         uint8 mins;

14:         uint8 secs;

15:         uint8 offset;

35:         uint16 year,

36:         uint8 month,

37:         uint8 day,

38:         uint8 hour,

39:         uint8 minute,

40:         uint8 second

48:         for (uint16 i = 1970; i < year; ++i) {

59:         for (uint8 i = 1; i < month; ++i) {

71:     function isLeapYear(uint16 year) internal pure returns (bool) {

```

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

31:     uint128 public nextMessageId;

64:     modifier sameChain(uint64 _chainId) {

89:         uint64 _timestamp = _suspend ? type(uint64).max : uint64(block.timestamp);

168:         uint64 receivedAt = proofReceipt[msgHash].receivedAt;

230:         uint64 receivedAt = proofReceipt[msgHash].receivedAt;  //@audit cache proofReceipt[msgHash]

392:     function isDestChainEnabled(uint64 _chainId)

541:     function _storeContext(bytes32 _msgHash, address _from, uint64 _srcChainId) private {

559:             uint64 srcChainId;

580:         uint64 _chainId,

```

```solidity
File: packages/protocol/contracts/bridge/IBridge.sol

19:         uint128 id;

24:         uint64 srcChainId;

26:         uint64 destChainId;

51:         uint64 receivedAt;

63:         uint64 srcChainId; // Source chain ID.

```

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

22:         uint64 indexed chainId, bytes32 indexed name, address newAddress, address oldAddress

39:         uint64 _chainId,

54:     function getAddress(uint64 _chainId, bytes32 _name) public view override returns (address) {

```

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

11:     uint8 private constant _FALSE = 1;

13:     uint8 private constant _TRUE = 2; //@audit pack

21:     uint8 private __reentry;

23:     uint8 private __paused;

119:     function _storeReentryLock(uint8 _reentry) internal virtual {

130:     function _loadReentryLock() internal view virtual returns (uint8 reentry_) {

```

```solidity
File: packages/protocol/contracts/common/IAddressManager.sol

14:     function getAddress(uint64 _chainId, bytes32 _name) external view returns (address);

```

```solidity
File: packages/protocol/contracts/libs/Lib4844.sol

13:     uint32 public constant FIELD_ELEMENTS_PER_BLOB = 4096;

```

```solidity
File: packages/protocol/contracts/signal/ISignalService.sol

21:         uint64 chainId;

21:         uint64 chainId;

22:         uint64 blockId;

22:         uint64 blockId;

37:         uint64 indexed chainId,

37:         uint64 indexed chainId,

38:         uint64 indexed blockId,

38:         uint64 indexed blockId,

69:         uint64 _chainId,

69:         uint64 _chainId,

71:         uint64 _blockId,

71:         uint64 _blockId,

85:         uint64 _chainId,

85:         uint64 _chainId,

106:         uint64 _chainId,

106:         uint64 _chainId,

108:         uint64 _blockId,

108:         uint64 _blockId,

123:         uint64 _chainId,

123:         uint64 _chainId,

125:         uint64 _blockId

125:         uint64 _blockId

129:         returns (uint64 blockId_, bytes32 chainData_);

129:         returns (uint64 blockId_, bytes32 chainData_);

138:         uint64 _chainId,

138:         uint64 _chainId,

140:         uint64 _blockId

140:         uint64 _blockId

```

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

17:     mapping(uint64 chainId => mapping(bytes32 kind => uint64 blockId)) public topBlockId;

17:     mapping(uint64 chainId => mapping(bytes32 kind => uint64 blockId)) public topBlockId;

69:         uint64 _chainId,

71:         uint64 _blockId,

84:         uint64 _chainId,

97:         uint64 chainId = _chainId;

138:         uint64 _chainId,

140:         uint64 _blockId,

159:         uint64 _chainId,

161:         uint64 _blockId

165:         returns (uint64 blockId_, bytes32 chainData_)

178:         uint64 _chainId,

180:         uint64 _blockId

195:         uint64 _chainId,

207:         uint64 _chainId,

236:         uint64 _chainId,

238:         uint64 _blockId,

273:         uint64 _chainId,

274:         uint64 _blockId,

```

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

29:         uint128 amount;

31:         uint128 costPerToken;

34:         uint64 grantStart;

37:         uint64 grantCliff;

40:         uint32 grantPeriod;

43:         uint64 unlockStart;

46:         uint64 unlockCliff;

49:         uint32 unlockPeriod;

53:         uint128 amountWithdrawn;

54:         uint128 costPaid;

68:     uint128 public totalAmountGranted;

71:     uint128 public totalAmountVoided;

74:     uint128 public totalAmountWithdrawn;

77:     uint128 public totalCostPaid;

92:     event Voided(address indexed recipient, uint128 amount);

99:     event Withdrawn(address indexed recipient, address to, uint128 amount, uint128 cost);

99:     event Withdrawn(address indexed recipient, address to, uint128 amount, uint128 cost);

152:         uint128 amountVoided = _voidGrant(r.grant);

180:             uint128 amountOwned,

181:             uint128 amountUnlocked,

182:             uint128 amountWithdrawn,

183:             uint128 amountToWithdraw,

184:             uint128 costToWithdraw

197:         uint128 _amountUnlocked = amountUnlocked / 1e18; // divide first

211:         (,,, uint128 amountToWithdraw, uint128 costToWithdraw) = getMyGrantSummary(_recipient);

211:         (,,, uint128 amountToWithdraw, uint128 costToWithdraw) = getMyGrantSummary(_recipient);

225:     function _voidGrant(Grant storage _grant) private returns (uint128 amountVoided) {

226:         uint128 amountOwned = _getAmountOwned(_grant);

246:         uint128 _amount,

247:         uint64 _start,

248:         uint64 _cliff,

249:         uint64 _period

273:     function _validateCliff(uint64 _start, uint64 _cliff, uint32 _period) private pure {

273:     function _validateCliff(uint64 _start, uint64 _cliff, uint32 _period) private pure {

273:     function _validateCliff(uint64 _start, uint64 _cliff, uint32 _period) private pure {

```

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol

29:         uint64 _claimStart,

30:         uint64 _claimEnd,

69:         (address delegatee, uint256 nonce, uint256 expiry, uint8 v, bytes32 r, bytes32 s) =

```

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

28:     uint64 public withdrawalWindow;

56:         uint64 _claimStart,

57:         uint64 _claimEnd,

61:         uint64 _withdrawalWindow

```

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

27:         uint64 _claimStart,

28:         uint64 _claimEnd,

```

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

18:     uint64 public claimStart;

21:     uint64 public claimEnd;

46:         uint64 _claimStart,

47:         uint64 _claimEnd,

57:         uint64 _claimStart,

58:         uint64 _claimEnd,

90:     function _setConfig(uint64 _claimStart, uint64 _claimEnd, bytes32 _merkleRoot) private {

90:     function _setConfig(uint64 _claimStart, uint64 _claimEnd, bytes32 _merkleRoot) private {

```

```solidity
File: packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

29:         uint16 _maxCopy,

```

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

30:     uint8 internal constant PREFIX_EXTENSION_EVEN = 0;

33:     uint8 internal constant PREFIX_EXTENSION_ODD = 1;

36:     uint8 internal constant PREFIX_LEAF_EVEN = 2;

39:     uint8 internal constant PREFIX_LEAF_ODD = 3;

134:                     uint8 branchKey = uint8(key[currentKeyIndex]);

141:                 uint8 prefix = uint8(path[0]);

142:                 uint8 offset = 2 - (prefix % 2);

```

```solidity
File: packages/protocol/contracts/tokenvault/BaseNFTVault.sol

13:         uint64 chainId;

25:         uint64 destChainId;

70:         uint64 indexed chainId,

90:         uint64 destChainId,

126:         uint64 srcChainId,

```

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

24:     uint8 private __srcDecimals;

57:         uint8 _decimals,

```

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

24:         uint64 chainId;

26:         uint8 decimals;

33:         uint64 destChainId;

69:         uint8 ctokenDecimal

87:         uint8 ctokenDecimal

102:         uint64 destChainId,

130:         uint64 srcChainId,

```

```solidity
File: packages/protocol/contracts/verifiers/IVerifier.sol

14:         uint64 blockId;

```

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

26:         uint64 validSince;

30:     uint64 public constant INSTANCE_EXPIRY = 180 days;

34:     uint64 public constant INSTANCE_VALIDITY_DELAY = 1 days;

154:         uint32 id = uint32(bytes4(Bytes.slice(_proof.data, 0, 4)));

204:         uint64 validSince = uint64(block.timestamp);

```
[[27]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/ITaikoL1.sol#L27)
,[[31]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/ITaikoL1.sol#L31)
,[[15]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L15)
,[[20]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L20)
,[[22]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L22)
,[[24]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L24)
,[[26]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L26)
,[[46]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L46)
,[[48]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L48)
,[[59]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L59)
,[[64]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L64)
,[[65]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L65)
,[[69]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L69)
,[[101]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L101)
,[[102]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L102)
,[[103]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L103)
,[[104]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L104)
,[[107]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L107)
,[[130]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L130)
,[[131]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L131)
,[[132]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L132)
,[[141]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L141)
,[[142]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L142)
,[[143]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L143)
,[[144]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L144)
,[[145]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L145)
,[[153]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L153)
,[[162]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L162)
,[[163]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L163)
,[[164]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L164)
,[[165]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L165)
,[[169]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L169)
,[[170]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L170)
,[[172]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L172)
,[[173]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L173)
,[[174]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L174)
,[[175]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L175)
,[[181]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L181)
,[[183]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L183)
,[[183]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L183)
,[[186]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L186)
,[[187]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L187)
,[[43]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L43)
,[[44]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L44)
,[[58]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L58)
,[[72]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L72)
,[[76]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L76)
,[[94]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L94)
,[[100]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L100)
,[[145]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L145)
,[[150]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L150)
,[[163]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L163)
,[[166]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L166)
,[[84]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L84)
,[[37]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L37)
,[[51]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L51)
,[[100]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L100)
,[[115]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L115)
,[[129]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L129)
,[[273]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L273)
,[[276]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L276)
,[[405]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L405)
,[[26]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L26)
,[[38]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L38)
,[[42]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L42)
,[[55]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L55)
,[[59]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L59)
,[[73]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L73)
,[[78]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L78)
,[[34]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L34)
,[[35]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L35)
,[[89]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L89)
,[[100]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L100)
,[[102]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L102)
,[[107]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L107)
,[[117]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L117)
,[[213]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L213)
,[[227]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L227)
,[[234]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L234)
,[[19]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L19)
,[[27]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L27)
,[[30]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L30)
,[[37]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L37)
,[[55]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L55)
,[[20]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L20)
,[[13]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L13)
,[[14]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L14)
,[[22]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L22)
,[[39]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L39)
,[[42]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L42)
,[[45]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L45)
,[[48]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L48)
,[[20]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L20)
,[[20]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L20)
,[[16]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L16)
,[[19]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L19)
,[[26]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L26)
,[[42]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L42)
,[[63]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L63)
,[[27]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L27)
,[[28]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L28)
,[[35]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L35)
,[[47]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L47)
,[[50]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L50)
,[[57]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L57)
,[[74]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L74)
,[[75]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L75)
,[[110]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L110)
,[[111]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L111)
,[[186]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L186)
,[[187]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L187)
,[[200]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L200)
,[[254]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L254)
,[[255]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L255)
,[[259]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L259)
,[[18]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L18)
,[[27]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L27)
,[[36]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L36)
,[[10]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/EnclaveIdStruct.sol#L10)
,[[23]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/EnclaveIdStruct.sol#L23)
,[[358]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L358)
,[[106]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106)
,[[249]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L249)
,[[250]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L250)
,[[26]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L26)
,[[27]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L27)
,[[34]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L34)
,[[39]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L39)
,[[43]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L43)
,[[196]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L196)
,[[188]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L188)
,[[198]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L198)
,[[211]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L211)
,[[332]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L332)
,[[9]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L9)
,[[10]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L10)
,[[11]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L11)
,[[12]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L12)
,[[13]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L13)
,[[14]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L14)
,[[15]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L15)
,[[35]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L35)
,[[36]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L36)
,[[37]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L37)
,[[38]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L38)
,[[39]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L39)
,[[40]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L40)
,[[48]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L48)
,[[59]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L59)
,[[71]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L71)
,[[31]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L31)
,[[64]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L64)
,[[89]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L89)
,[[168]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L168)
,[[230]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L230)
,[[392]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L392)
,[[541]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L541)
,[[559]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L559)
,[[580]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L580)
,[[19]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L19)
,[[24]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L24)
,[[26]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L26)
,[[51]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L51)
,[[63]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L63)
,[[22]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L22)
,[[39]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L39)
,[[54]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L54)
,[[11]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L11)
,[[13]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L13)
,[[21]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L21)
,[[23]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L23)
,[[119]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L119)
,[[130]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L130)
,[[14]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressManager.sol#L14)
,[[13]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L13)
,[[21]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L21)
,[[21]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L21)
,[[22]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L22)
,[[22]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L22)
,[[37]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L37)
,[[37]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L37)
,[[38]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L38)
,[[38]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L38)
,[[69]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L69)
,[[69]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L69)
,[[71]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L71)
,[[71]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L71)
,[[85]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L85)
,[[85]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L85)
,[[106]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L106)
,[[106]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L106)
,[[108]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L108)
,[[108]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L108)
,[[123]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L123)
,[[123]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L123)
,[[125]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L125)
,[[125]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L125)
,[[129]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L129)
,[[129]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L129)
,[[138]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L138)
,[[138]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L138)
,[[140]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L140)
,[[140]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L140)
,[[17]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L17)
,[[17]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L17)
,[[69]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L69)
,[[71]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L71)
,[[84]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L84)
,[[97]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L97)
,[[138]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L138)
,[[140]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L140)
,[[159]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L159)
,[[161]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L161)
,[[165]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L165)
,[[178]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L178)
,[[180]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L180)
,[[195]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L195)
,[[207]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L207)
,[[236]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L236)
,[[238]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L238)
,[[273]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L273)
,[[274]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L274)
,[[29]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L29)
,[[31]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L31)
,[[34]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L34)
,[[37]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L37)
,[[40]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L40)
,[[43]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L43)
,[[46]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L46)
,[[49]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L49)
,[[53]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L53)
,[[54]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L54)
,[[68]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L68)
,[[71]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L71)
,[[74]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L74)
,[[77]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L77)
,[[92]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L92)
,[[99]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L99)
,[[99]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L99)
,[[152]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L152)
,[[180]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L180)
,[[181]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L181)
,[[182]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L182)
,[[183]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L183)
,[[184]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L184)
,[[197]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L197)
,[[211]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L211)
,[[211]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L211)
,[[225]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L225)
,[[226]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L226)
,[[246]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L246)
,[[247]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L247)
,[[248]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L248)
,[[249]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L249)
,[[273]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L273)
,[[273]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L273)
,[[273]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L273)
,[[29]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L29)
,[[30]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L30)
,[[69]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L69)
,[[28]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L28)
,[[56]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L56)
,[[57]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L57)
,[[61]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L61)
,[[27]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L27)
,[[28]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L28)
,[[18]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L18)
,[[21]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L21)
,[[46]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L46)
,[[47]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L47)
,[[57]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L57)
,[[58]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L58)
,[[90]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L90)
,[[90]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L90)
,[[29]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L29)
,[[30]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L30)
,[[33]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L33)
,[[36]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L36)
,[[39]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L39)
,[[134]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L134)
,[[141]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L141)
,[[142]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L142)
,[[13]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L13)
,[[25]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L25)
,[[70]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L70)
,[[90]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L90)
,[[126]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L126)
,[[24]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L24)
,[[57]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L57)
,[[24]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L24)
,[[26]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L26)
,[[33]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L33)
,[[69]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L69)
,[[87]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L87)
,[[102]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L102)
,[[130]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L130)
,[[14]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/IVerifier.sol#L14)
,[[26]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L26)
,[[30]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L30)
,[[34]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L34)
,[[154]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L154)
,[[204]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L204)
,
</details>



Instances of this issue:

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

335:             require(char >= 0x30 && char <= 0x7A, "invalid char");

```
[[335]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L335)
,
 ### [GAS-24] Using this to access functions results in an external call, wasting gas
External calls have an overhead of 100 gas, which can be avoided by not referencing the function using this. Contracts are allowed to override their parents' functions and change the visibility from external to public, so make this change if it's required in order to call the function internally.


Instances of this issue:

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

281:             this.onMessageInvocation, abi.encode(ctoken_, _user, _op.to, _op.tokenIds, _op.amounts)

```

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

384:             this.onMessageInvocation, abi.encode(ctoken_, _user, _to, balanceChange_)

```

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

217:             this.onMessageInvocation, abi.encode(ctoken_, _user, _op.to, _op.tokenIds)

```
[[281]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L281)
,[[384]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L384)
,[[217]](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L217)
,